args: {'device': 'cuda:0', 'clip_model': 'ViT-B/32', 'language_model': 'gpt2', 'continuous_prompt_length': 10, 'clip_project_length': 10, 'temperature': 0.01, 'top_k': 3, 'threshold': 0.2, 'using_image_features': True, 'name_of_datasets': 'flickr30k', 'path_of_val_datasets': './annotations/flickr30k/test_captions.json', 'disable_all_entities': False, 'name_of_entities_text': 'vinvl_vgoi_entities', 'prompt_ensemble': True, 'weight_path': 'checkpoints/coco_train_1/coco_prefix-0014.pt', 'image_folder': './annotations/flickr30k/flickr30k-images/', 'out_path': 'checkpoints/coco_train_1', 'using_hard_prompt': True, 'soft_prompt_first': True, 'only_hard_prompt': False, 'using_greedy_search': True, 'beam_width': 5, 'debug': False, 'text_prompt': None}

0it [00:00, ?it/s]1it [00:00,  1.51it/s]2it [00:00,  2.97it/s]4it [00:00,  5.31it/s]6it [00:01,  6.91it/s]8it [00:01,  7.54it/s]9it [00:01,  7.88it/s]10it [00:01,  7.95it/s]12it [00:01,  9.21it/s]14it [00:01,  9.93it/s]16it [00:02, 10.14it/s]18it [00:02,  9.96it/s]20it [00:02,  9.58it/s]22it [00:02,  8.87it/s]23it [00:02,  9.05it/s]25it [00:03,  9.28it/s]27it [00:03,  9.78it/s]29it [00:03, 10.01it/s]31it [00:03, 10.07it/s]33it [00:03,  9.97it/s]35it [00:04,  9.63it/s]37it [00:04,  9.97it/s]39it [00:04,  9.99it/s]41it [00:04,  8.92it/s]42it [00:04,  9.00it/s]44it [00:05,  9.70it/s]45it [00:05,  9.61it/s]47it [00:05, 10.06it/s]49it [00:05,  9.99it/s]51it [00:05,  9.41it/s]52it [00:05,  9.27it/s]54it [00:06,  9.65it/s]56it [00:06,  9.81it/s]57it [00:06,  9.73it/s]59it [00:06,  9.28it/s]60it [00:06,  9.13it/s]62it [00:06,  9.66it/s]64it [00:07, 10.06it/s]65it [00:07,  9.90it/s]66it [00:07,  9.77it/s]68it [00:07, 10.34it/s]70it [00:07,  9.73it/s]72it [00:07, 10.12it/s]74it [00:08, 10.67it/s]76it [00:08, 10.35it/s]78it [00:08,  9.39it/s]80it [00:08,  9.74it/s]82it [00:08,  9.98it/s]84it [00:09, 10.16it/s]86it [00:09, 10.17it/s]88it [00:09, 10.39it/s]90it [00:09, 10.85it/s]92it [00:09, 10.64it/s]94it [00:10, 10.47it/s]96it [00:10, 10.64it/s]98it [00:10, 10.74it/s]100it [00:10, 10.68it/s]102it [00:10, 10.26it/s]104it [00:11, 10.21it/s]106it [00:11, 10.42it/s]108it [00:11, 10.21it/s]110it [00:11, 10.31it/s]112it [00:11, 10.15it/s]114it [00:12, 10.04it/s]116it [00:12,  9.74it/s]117it [00:12,  9.31it/s]119it [00:12,  9.59it/s]120it [00:12,  9.56it/s]122it [00:12, 10.46it/s]124it [00:13, 10.22it/s]126it [00:13,  9.82it/s]128it [00:13, 10.40it/s]130it [00:13, 10.58it/s]132it [00:13, 10.14it/s]134it [00:14, 10.14it/s]136it [00:14, 10.03it/s]138it [00:14, 10.07it/s]140it [00:14, 10.15it/s]142it [00:14,  9.88it/s]144it [00:15, 10.18it/s]146it [00:15, 10.41it/s]148it [00:15, 10.49it/s]150it [00:15, 10.09it/s]152it [00:15,  9.93it/s]154it [00:15, 10.48it/s]156it [00:16, 10.15it/s]158it [00:16, 10.52it/s]160it [00:16,  9.61it/s]161it [00:16,  9.44it/s]162it [00:16,  9.52it/s]164it [00:17, 10.01it/s]166it [00:17,  9.92it/s]167it [00:17,  9.68it/s]169it [00:17,  9.72it/s]170it [00:17,  9.67it/s]171it [00:17,  9.62it/s]173it [00:17,  9.98it/s]174it [00:18,  9.86it/s]176it [00:18,  9.99it/s]178it [00:18, 10.34it/s]180it [00:18,  9.38it/s]182it [00:18,  9.74it/s]184it [00:19, 10.11it/s]186it [00:19, 10.52it/s]188it [00:19, 10.39it/s]190it [00:19, 10.42it/s]192it [00:19, 10.61it/s]194it [00:19, 10.33it/s]196it [00:20, 10.13it/s]198it [00:20, 10.27it/s]200it [00:20,  9.78it/s]201it [00:20,  9.71it/s]203it [00:20, 10.26it/s]205it [00:21, 10.30it/s]207it [00:21,  9.51it/s]208it [00:21,  9.56it/s]210it [00:21,  9.70it/s]212it [00:21, 10.02it/s]214it [00:22,  9.79it/s]216it [00:22, 10.04it/s]218it [00:22, 10.12it/s]220it [00:22,  9.80it/s]222it [00:22, 10.16it/s]224it [00:23, 10.33it/s]226it [00:23, 10.41it/s]228it [00:23,  9.87it/s]230it [00:23, 10.11it/s]232it [00:23, 10.14it/s]234it [00:24,  9.92it/s]236it [00:24, 10.11it/s]238it [00:24, 10.22it/s]240it [00:24, 10.27it/s]242it [00:24, 10.13it/s]244it [00:25,  9.52it/s]245it [00:25,  9.37it/s]247it [00:25,  8.93it/s]248it [00:25,  8.87it/s]250it [00:25,  9.72it/s]252it [00:25,  9.27it/s]254it [00:26,  9.58it/s]256it [00:26, 10.00it/s]258it [00:26, 10.56it/s]260it [00:26, 10.45it/s]262it [00:26, 10.62it/s]264it [00:27, 10.24it/s]266it [00:27, 10.10it/s]268it [00:27,  9.99it/s]270it [00:27,  9.82it/s]271it [00:27,  9.26it/s]272it [00:27,  9.29it/s]274it [00:28, 10.13it/s]276it [00:28, 10.01it/s]278it [00:28,  9.93it/s]280it [00:28, 10.27it/s]282it [00:28,  9.76it/s]284it [00:29,  9.89it/s]286it [00:29,  9.98it/s]288it [00:29, 10.53it/s]290it [00:29, 10.68it/s]292it [00:29, 10.93it/s]294it [00:30, 10.44it/s]296it [00:30, 10.62it/s]298it [00:30, 10.11it/s]300it [00:30, 10.14it/s]302it [00:30,  9.81it/s]304it [00:31, 10.03it/s]306it [00:31, 10.07it/s]308it [00:31, 10.09it/s]310it [00:31, 10.00it/s]312it [00:31,  9.83it/s]314it [00:32,  9.93it/s]316it [00:32, 10.01it/s]318it [00:32,  9.91it/s]319it [00:32,  9.74it/s]320it [00:32,  9.53it/s]322it [00:32, 10.33it/s]324it [00:33, 10.14it/s]326it [00:33, 10.36it/s]328it [00:33,  9.68it/s]329it [00:33,  9.68it/s]331it [00:33,  9.84it/s]332it [00:33,  9.48it/s]334it [00:34,  9.58it/s]335it [00:34,  9.55it/s]336it [00:34,  9.49it/s]337it [00:34,  9.47it/s]338it [00:34,  9.42it/s]340it [00:34,  9.68it/s]342it [00:34, 10.29it/s]344it [00:35,  9.98it/s]346it [00:35,  9.92it/s]347it [00:35,  9.82it/s]349it [00:35,  9.95it/s]351it [00:35, 10.05it/s]353it [00:36,  9.61it/s]355it [00:36,  9.79it/s]356it [00:36,  9.59it/s]358it [00:36,  9.92it/s]360it [00:36, 10.25it/s]362it [00:36, 10.60it/s]364it [00:37,  9.39it/s]365it [00:37,  9.28it/s]366it [00:37,  8.28it/s]367it [00:37,  8.52it/s]368it [00:37,  7.90it/s]369it [00:37,  7.81it/s]370it [00:37,  8.27it/s]371it [00:38,  8.40it/s]373it [00:38,  8.84it/s]374it [00:38,  8.97it/s]375it [00:38,  8.35it/s]377it [00:38,  9.03it/s]378it [00:38,  8.36it/s]380it [00:39,  9.25it/s]381it [00:39,  9.15it/s]383it [00:39,  9.53it/s]385it [00:39,  9.88it/s]387it [00:39,  9.98it/s]389it [00:39,  9.93it/s]391it [00:40, 10.00it/s]392it [00:40,  9.75it/s]394it [00:40, 10.00it/s]396it [00:40,  9.69it/s]397it [00:40,  9.36it/s]398it [00:40,  9.48it/s]400it [00:41,  9.99it/s]401it [00:41,  9.86it/s]403it [00:41, 10.10it/s]405it [00:41,  9.70it/s]406it [00:41,  9.63it/s]408it [00:41,  9.93it/s]409it [00:41,  9.81it/s]411it [00:42, 10.21it/s]413it [00:42, 10.02it/s]414it [00:42,  9.73it/s]416it [00:42, 10.14it/s]418it [00:42,  9.87it/s]420it [00:43,  9.95it/s]422it [00:43, 10.00it/s]424it [00:43,  9.70it/s]426it [00:43,  9.95it/s]428it [00:43, 10.26it/s]430it [00:44, 10.12it/s]432it [00:44, 10.02it/s]434it [00:44, 10.07it/s]436it [00:44,  9.64it/s]438it [00:44, 10.26it/s]440it [00:45, 10.12it/s]442it [00:45, 10.63it/s]444it [00:45, 10.34it/s]446it [00:45, 10.23it/s]448it [00:45, 10.18it/s]450it [00:46, 10.40it/s]452it [00:46, 10.19it/s]454it [00:46, 10.22it/s]456it [00:46,  9.75it/s]457it [00:46,  9.45it/s]458it [00:46,  9.32it/s]460it [00:47,  9.88it/s]462it [00:47,  9.72it/s]464it [00:47, 10.11it/s]466it [00:47, 10.38it/s]468it [00:47, 10.58it/s]470it [00:47, 10.45it/s]472it [00:48, 10.26it/s]474it [00:48,  9.94it/s]476it [00:48, 10.35it/s]478it [00:48,  9.84it/s]480it [00:49,  9.94it/s]482it [00:49, 10.21it/s]484it [00:49, 10.20it/s]486it [00:49, 10.44it/s]488it [00:49, 10.37it/s]490it [00:49, 10.07it/s]492it [00:50, 10.57it/s]494it [00:50, 10.70it/s]496it [00:50, 10.29it/s]498it [00:50, 10.22it/s]500it [00:50, 10.09it/s]502it [00:51, 10.23it/s]504it [00:51, 10.59it/s]506it [00:51, 10.58it/s]508it [00:51, 10.72it/s]510it [00:51, 10.25it/s]512it [00:52, 10.35it/s]514it [00:52, 10.42it/s]516it [00:52, 10.48it/s]518it [00:52, 10.60it/s]520it [00:52, 10.22it/s]522it [00:53, 10.57it/s]524it [00:53, 10.45it/s]526it [00:53, 10.59it/s]528it [00:53, 10.06it/s]530it [00:53, 10.31it/s]532it [00:54, 10.05it/s]534it [00:54, 10.06it/s]536it [00:54,  9.95it/s]538it [00:54, 10.22it/s]540it [00:54, 10.50it/s]542it [00:54, 10.39it/s]544it [00:55, 10.43it/s]546it [00:55, 10.21it/s]548it [00:55, 10.30it/s]550it [00:55, 10.01it/s]552it [00:55, 10.40it/s]554it [00:56, 10.20it/s]556it [00:56,  9.95it/s]558it [00:56, 10.13it/s]560it [00:56, 10.15it/s]562it [00:56, 10.28it/s]564it [00:57, 10.24it/s]566it [00:57, 10.21it/s]568it [00:57, 10.19it/s]570it [00:57, 10.43it/s]572it [00:57, 10.60it/s]574it [00:58, 10.35it/s]576it [00:58, 10.54it/s]578it [00:58, 10.82it/s]580it [00:58, 10.75it/s]582it [00:58, 10.44it/s]584it [00:59, 10.67it/s]586it [00:59, 10.27it/s]588it [00:59, 10.01it/s]590it [00:59, 10.18it/s]592it [00:59, 10.68it/s]594it [01:00, 10.53it/s]596it [01:00, 10.68it/s]598it [01:00, 10.28it/s]600it [01:00,  9.90it/s]601it [01:00,  9.80it/s]602it [01:00,  9.56it/s]603it [01:00,  9.37it/s]604it [01:01,  9.07it/s]605it [01:01,  8.99it/s]607it [01:01,  9.61it/s]609it [01:01, 10.10it/s]611it [01:01, 10.55it/s]613it [01:01,  9.89it/s]615it [01:02,  9.95it/s]617it [01:02, 10.08it/s]619it [01:02, 10.23it/s]621it [01:02, 10.19it/s]623it [01:02, 10.57it/s]625it [01:03, 10.08it/s]627it [01:03, 10.12it/s]629it [01:03, 10.64it/s]631it [01:03, 10.63it/s]633it [01:03, 10.50it/s]635it [01:04, 10.05it/s]637it [01:04,  9.73it/s]639it [01:04,  9.46it/s]641it [01:04,  9.89it/s]642it [01:04,  9.80it/s]643it [01:04,  9.73it/s]645it [01:05, 10.17it/s]647it [01:05, 10.30it/s]649it [01:05, 10.38it/s]651it [01:05, 10.45it/s]653it [01:05, 10.77it/s]655it [01:06, 10.20it/s]657it [01:06,  9.74it/s]659it [01:06,  9.98it/s]661it [01:06,  9.92it/s]662it [01:06,  9.83it/s]664it [01:06, 10.35it/s]666it [01:07, 10.29it/s]668it [01:07, 10.79it/s]670it [01:07, 10.46it/s]672it [01:07, 10.38it/s]674it [01:07, 10.85it/s]676it [01:08, 10.49it/s]678it [01:08, 10.65it/s]680it [01:08, 10.26it/s]682it [01:08, 10.11it/s]684it [01:08, 10.01it/s]686it [01:09, 10.42it/s]688it [01:09, 10.10it/s]690it [01:09, 10.12it/s]692it [01:09, 10.27it/s]694it [01:09, 10.12it/s]696it [01:10, 10.26it/s]698it [01:10,  9.14it/s]700it [01:10,  9.53it/s]702it [01:10,  9.94it/s]704it [01:10, 10.24it/s]706it [01:11, 10.35it/s]708it [01:11,  9.94it/s]710it [01:11,  9.89it/s]711it [01:11,  9.56it/s]713it [01:11,  9.51it/s]714it [01:11,  8.99it/s]715it [01:12,  9.07it/s]717it [01:12,  7.99it/s]719it [01:12,  8.72it/s]721it [01:12,  9.16it/s]722it [01:12,  9.10it/s]724it [01:13,  9.69it/s]726it [01:13,  9.80it/s]728it [01:13, 10.30it/s]730it [01:13, 10.10it/s]732it [01:13,  9.89it/s]734it [01:14,  9.31it/s]735it [01:14,  8.51it/s]736it [01:14,  7.76it/s]737it [01:14,  7.73it/s]738it [01:14,  7.36it/s]739it [01:14,  7.90it/s]740it [01:14,  8.26it/s]741it [01:15,  8.26it/s]742it [01:15,  8.40it/s]744it [01:15,  9.42it/s]746it [01:15, 10.30it/s]748it [01:15,  9.11it/s]750it [01:16,  9.00it/s]752it [01:16,  9.47it/s]754it [01:16,  9.92it/s]756it [01:16,  9.88it/s]758it [01:16, 10.34it/s]760it [01:17,  9.60it/s]761it [01:17,  9.45it/s]762it [01:17,  9.04it/s]764it [01:17,  9.56it/s]765it [01:17,  8.58it/s]767it [01:17,  9.24it/s]769it [01:17,  9.92it/s]770it [01:18,  9.81it/s]771it [01:18,  9.12it/s]773it [01:18,  9.65it/s]775it [01:18, 10.11it/s]777it [01:18, 10.42it/s]779it [01:18, 10.91it/s]781it [01:19, 10.14it/s]783it [01:19, 10.02it/s]785it [01:19,  9.84it/s]786it [01:19,  9.15it/s]788it [01:19,  9.72it/s]790it [01:20,  9.87it/s]792it [01:20,  9.74it/s]794it [01:20,  9.49it/s]796it [01:20, 10.01it/s]798it [01:20,  9.37it/s]799it [01:21,  9.38it/s]801it [01:21,  9.76it/s]803it [01:21, 10.27it/s]805it [01:21,  9.98it/s]807it [01:21, 10.17it/s]809it [01:22,  9.60it/s]810it [01:22,  9.20it/s]811it [01:22,  9.24it/s]813it [01:22, 10.05it/s]815it [01:22, 10.38it/s]817it [01:22, 10.19it/s]819it [01:23,  9.59it/s]821it [01:23, 10.25it/s]823it [01:23, 10.11it/s]825it [01:23, 10.38it/s]827it [01:23, 10.71it/s]829it [01:23, 10.29it/s]831it [01:24, 10.26it/s]833it [01:24, 10.74it/s]835it [01:24, 10.32it/s]837it [01:24, 10.80it/s]839it [01:24, 10.26it/s]841it [01:25, 10.24it/s]843it [01:25,  9.77it/s]845it [01:25, 10.01it/s]847it [01:25,  9.73it/s]849it [01:25,  9.86it/s]851it [01:26,  9.96it/s]853it [01:26, 10.02it/s]855it [01:26,  9.96it/s]857it [01:26, 10.03it/s]859it [01:26, 10.08it/s]861it [01:27,  9.23it/s]863it [01:27,  9.16it/s]864it [01:27,  9.20it/s]866it [01:27,  9.37it/s]868it [01:27,  9.95it/s]870it [01:28,  9.88it/s]871it [01:28,  9.77it/s]873it [01:28, 10.01it/s]875it [01:28, 10.46it/s]877it [01:28, 10.45it/s]879it [01:28, 10.60it/s]881it [01:29, 10.31it/s]883it [01:29, 10.55it/s]885it [01:29, 10.41it/s]887it [01:29, 10.05it/s]889it [01:29, 10.08it/s]891it [01:30,  9.86it/s]893it [01:30, 10.04it/s]895it [01:30, 10.30it/s]897it [01:30, 10.09it/s]899it [01:30, 10.31it/s]901it [01:31, 10.59it/s]903it [01:31, 10.36it/s]905it [01:31, 10.04it/s]907it [01:31, 10.44it/s]909it [01:31, 10.46it/s]911it [01:32,  9.89it/s]913it [01:32,  9.14it/s]914it [01:32,  8.96it/s]915it [01:32,  8.91it/s]917it [01:32,  9.44it/s]918it [01:32,  9.16it/s]920it [01:33,  9.62it/s]922it [01:33,  9.80it/s]923it [01:33,  9.58it/s]924it [01:33,  9.39it/s]925it [01:33,  9.39it/s]926it [01:33,  9.39it/s]928it [01:33, 10.00it/s]930it [01:34, 10.37it/s]932it [01:34,  9.89it/s]933it [01:34,  9.50it/s]935it [01:34,  9.88it/s]936it [01:34,  9.79it/s]937it [01:34,  9.55it/s]938it [01:34,  9.52it/s]940it [01:35, 10.10it/s]942it [01:35, 10.43it/s]944it [01:35,  9.78it/s]945it [01:35,  9.81it/s]946it [01:35,  9.25it/s]948it [01:36,  9.31it/s]949it [01:36,  8.64it/s]951it [01:36,  9.16it/s]952it [01:36,  8.68it/s]954it [01:36,  9.44it/s]956it [01:36,  9.99it/s]958it [01:37, 10.20it/s]960it [01:37, 10.08it/s]962it [01:37, 10.11it/s]964it [01:37, 10.01it/s]965it [01:37,  9.91it/s]966it [01:37,  9.80it/s]968it [01:38,  9.80it/s]970it [01:38, 10.19it/s]972it [01:38, 10.59it/s]974it [01:38, 10.74it/s]976it [01:38, 10.45it/s]978it [01:39, 10.48it/s]980it [01:39,  9.54it/s]982it [01:39,  9.49it/s]984it [01:39,  9.56it/s]986it [01:39,  9.82it/s]987it [01:39,  9.42it/s]988it [01:40,  8.90it/s]990it [01:40,  9.32it/s]991it [01:40,  9.20it/s]993it [01:40,  9.93it/s]995it [01:40, 10.56it/s]997it [01:40, 10.28it/s]999it [01:41,  9.94it/s]1000it [01:41,  9.43it/s]1000it [01:41,  9.87it/s]
PTBTokenizer tokenized 72436 tokens at 481572.33 tokens per second.
PTBTokenizer tokenized 11655 tokens at 138630.46 tokens per second.
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.nustaq.serialization.FSTClazzInfo (file:/raid/speech/rajgothi/Project/ViECap/evaluation/pycocoevalcap/spice/lib/fst-2.47.jar) to field java.lang.String.value
WARNING: Please consider reporting this to the maintainers of org.nustaq.serialization.FSTClazzInfo
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
Parsing reference captions
Parsing test captions
Initiating Stanford parsing pipeline
[main] INFO edu.stanford.nlp.pipeline.StanfordCoreNLP - Adding annotator tokenize
[main] INFO edu.stanford.nlp.pipeline.TokenizerAnnotator - TokenizerAnnotator: No tokenizer type provided. Defaulting to PTBTokenizer.
[main] INFO edu.stanford.nlp.pipeline.StanfordCoreNLP - Adding annotator ssplit
[main] INFO edu.stanford.nlp.pipeline.StanfordCoreNLP - Adding annotator parse
[main] INFO edu.stanford.nlp.parser.common.ParserGrammar - Loading parser from serialized file edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz ... 
done [0.3 sec].
[main] INFO edu.stanford.nlp.pipeline.StanfordCoreNLP - Adding annotator lemma
[main] INFO edu.stanford.nlp.pipeline.StanfordCoreNLP - Adding annotator ner
Loading classifier from edu/stanford/nlp/models/ner/english.all.3class.distsim.crf.ser.gz ... done [0.9 sec].
Loading classifier from edu/stanford/nlp/models/ner/english.muc.7class.distsim.crf.ser.gz ... done [0.5 sec].
Loading classifier from edu/stanford/nlp/models/ner/english.conll.4class.distsim.crf.ser.gz ... done [0.5 sec].
Threads( StanfordCoreNLP ) [4.481 seconds]
Warning: Nashorn engine is planned to be removed from a future JDK release
SPICE evaluation took: 9.656 s
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9648, 'reflen': 9687, 'guess': [9648, 8648, 7648, 6648], 'correct': [6075, 2421, 839, 288]}
ratio: 0.9959739857540005
Bleu_1: 0.627
Bleu_2: 0.418
Bleu_3: 0.267
Bleu_4: 0.169
computing METEOR score...
METEOR: 0.178
computing Rouge score...
ROUGE_L: 0.421
computing CIDEr score...
CIDEr: 0.381
computing SPICE score...
SPICE: 0.108
Bleu_1: 0.627
Bleu_2: 0.418
Bleu_3: 0.267
Bleu_4: 0.169
METEOR: 0.178
ROUGE_L: 0.421
CIDEr: 0.381
SPICE: 0.108
